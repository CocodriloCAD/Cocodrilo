## Current state of the development of a MPM-Preprocessor using Cocodrilo

Dec '22

The transient analysis of a cantilever beam under dead load has been validated with the .json and .mdpa files which can be found in the directories files_GID and files_Cocodrilo. The results for the Kratos input files from Cocodrilo are the same as the results for the files from GID. This can be seen in detail in the excel-file "Validation_results".

Jan '22

The static analysis of the cantilever example, which has been used for the validation of the transient analysis, was also validated. The details can be found in the excel-file "Validation_results". The respective GID-files can be generated by changing the analysis type in GID to "static" and writing the calculation files subsequently.



For more complex geometries, boundary conditions and other analyses no validation was conducted so far. Therefore, errors are likely to occur. 

# Documentation: How to use Rhino/Grasshopper & Cocodrilo to generate simulation files for the KRATOS Multiphysics MPM Application

## Linear Analysis example
This how-to shows how to set up simulation files for a linear static analysis with the KRATOS Multiphysics (Link einfügen) MPM Application (Link einfügen) with Cocodrilo, a plug in for Grasshopper/ Rhino. For that purpose a cantilever beam is modeled and analyzed with MPM. The results of the analysis based on the *Cocodrilo* files are compared to the results of an analysis based on GiD (Link einfügen).

![grafik](https://user-images.githubusercontent.com/51473791/221582986-856d6c0f-cadf-46e5-9573-78aa4f81ea42.png)


Table of contents:

1) General User Interface
2) Define analysis
3) Set up geometry 
4) Define boundary conditions
5) Choose material
6) Define mesh
7) Generate calcualtion files
8) Remove errors
9) Limitations of the current software version

#### 1) General User Interface

The graphical user interface of Cocodrilo/Grasshopper/Rhino is depicted in the figure below: 
![grafik](https://user-images.githubusercontent.com/51473791/221424826-ef5c6955-fe54-47cc-8d4e-202bc5510391.png)

To see the menues *Analyses, DEM, Elements, Geometry, Materials, Models and Postproessing* of Cocodrilo, click on *Cocodrilo* in  the line above, as indicated by the red rectangle. 

### 2) Define analysis method
To create a new model resp. analysis, set up a new, empty canvas in Grasshopper. For a MPM analysis, add the *Material point method* analyis from the *Analyses*-menu to the canvas by clicking on *MPM* firstly, and clicking on the canvas secondly.

![grafik](https://user-images.githubusercontent.com/51473791/221430285-af621478-7425-4302-b9d2-bc8d66afc1a1.png)

![grafik](https://user-images.githubusercontent.com/51473791/221428914-228ebd5c-2b22-419c-a88d-2e94d2b1bd7d.png)

For a linear, static analysis (LSA) of the cantilever, add a linear static analysis in a next step:

![grafik](https://user-images.githubusercontent.com/51473791/221426370-610b969b-788d-434d-891a-4ffafd053a62.png)

![grafik](https://user-images.githubusercontent.com/51473791/221427289-a2cd1b8e-8a22-4c9d-84c0-429a7c10ca04.png)

When both fields (*MPM Analysis and LSA*) are present, connect them with a line: 

![grafik](https://user-images.githubusercontent.com/51473791/221429003-4f8f0e8d-05ca-4b31-a62c-9a47a5aef40e.png)


Now the desired analysis field is present on the canvas. In the next step we will add the geometry.

### 3) Geometry
The basis for setting up the geometry is the *Geo*-node within the *MPM*-field. Due to the internal data structure of *Cocodrilo*, a lot of information of the modelled problem is entered via the *Geo*-node. For example, later we will see that the input data for material parameters, boundary conditions and the body-mesh are entered via the *Geo*-node.

#### Cantilever beam
In order to model the cantilever beam which is depicted below, we have to add a *solid*-element. However, this element is not an element in the sense of a finite-element, e.g. a plate element with 2 dofs at each corner, but rather an object in the sense of object-oriented-programming which has the mesh, the material and the thickness of the structure which shall be modelled as member variables. 

![grafik](https://user-images.githubusercontent.com/51473791/221550075-c992e18d-27a5-4cc2-a193-49205816d817.png)

After adding the *solid*-element, a *MPM-Material*- as well as a *MPlane*-field have to be added. 

![grafik](https://user-images.githubusercontent.com/51473791/221549704-cd9d943b-44da-43e6-b77b-a39d0ffac3ec.png)

For the *MPlane*(=mesh plane)-field click on the section "Mesh":

![grafik](https://user-images.githubusercontent.com/51473791/221550515-558ef1c6-e860-4be5-91f5-12007b9b39e5.png)

Add all these fields to the plane and connect them as shown in the picture below:

![grafik](https://user-images.githubusercontent.com/51473791/221551013-b48299e0-be5e-426a-bee3-9904fefad170.png)

To set the width and length of the beam, right click the *B*-node of the *MPlane* field. Then the subsequent depicted menu opens:

![grafik](https://user-images.githubusercontent.com/51473791/221567498-e5cfb713-e7a0-46c1-825f-73c8a330cae0.png)

Choose "Set one rectangle", as indicated by the red rectangle. Subsequently, the GUI of Rhino will appear where the dimensions of the cantilever beam can be entered.

![grafik](https://user-images.githubusercontent.com/51473791/221569196-23fdf884-f1d1-4a2e-9b56-940ca21382d2.png)

Add in the line which is indicated by the red rectangle the coordinates for the cantilever beam in the following way:
- Point 1: 0.0,0.5 
- Point 2: 1.5,0.5
- Point 3: 1.5,1.5

Finally, confirm the coordinates by hitting "enter" and the Grasshopper-canvas will appear again. If you click once a again on "Set one rectangle", you should see the following rectangle in Rhino:

![grafik](https://user-images.githubusercontent.com/51473791/221571181-b220da8a-a3d4-40dc-adf2-01e86d39a26c.png)

### 4) Meshing of the cantilever
In this example we want to mesh the cantilever with a quadrilateral mesh with a length of 0.1m. For that purpose, right click *w* and "Set integer". Here, enter 15, as we have a cantilever with a length of 1.5m and with 15 elements in the x-direction, each element has length of 0.1m in the x-direction.
Subsequently, set analogously *n* to 10.







